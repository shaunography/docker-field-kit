### impacket ###
alias dimpacket='docker run --rm -ti --network host -v /media:/media -v $HOME:$HOME impacket'
alias dsmbclient='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket smbclient.py'
alias dntlmrelayx='docker run --rm -ti --network host -v /media:/media -v $HOME:$HOME impacket ntlmrelayx.py'
alias dsecretsdump='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket secretsdump.py'
alias dGetADUsers='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket GetADUsers.py'
alias dgetTGT='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket getTGT.py'
alias dGetUserSPNs='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket GetUserSPNs.py'
alias dGetNPUsers='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket GetNPUsers.py'
alias dwmiexec='docker run --rm -ti -v /media:/media -v $HOME:$HOME impacket wmiexec.py'
alias dsmbserver='docker run --rm -ti --network host -v /media:/media -v $HOME:$HOME impacket smbserver.py'

dsmbservehere() {
        local sharename
        [[ -z $1 ]] && sharename="SHARE" || sharename=$1
        docker run --rm -it -p 445:445 -v "${PWD}:/tmp/serve" impacket smbserver.py -smb2support $sharename /tmp/serve
}
